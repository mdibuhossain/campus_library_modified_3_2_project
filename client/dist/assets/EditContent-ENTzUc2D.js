import{r as u,l as K,O as V,R as Y,p as v,j as i,P as z,t as J,G as k,U as X,v as E,Q as Z,x as L,S as $}from"./index-GKI_nvxQ.js";import{u as ee}from"./useAuth-jLoE7eOX.js";import{u as se}from"./useUtility-PP_7Ruak.js";import{C as ie,s as te,L as ae}from"./semesterList-DIomgtJK.js";import{T as le}from"./Typography-gxwCmCST.js";import{B as U}from"./Box-ofb-7Xsj.js";import{F as y,I as _,S as T,T as d}from"./TextField-o1M_kqnY.js";import{M as o,T as ne}from"./Tooltip-2KFdrYXf.js";import{G as C}from"./Grid-XA8nRS57.js";import{L as oe}from"./LoadingButton-A3N80UNP.js";import{B as re}from"./Button-Cvab_h2v.js";import"./createSvgIcon-MbVgV0wn.js";import"./isHostComponent-A04i3924.js";import"./extendSxProp-9ORc9l6X.js";import"./createBox-aGKtu-i3.js";import"./InputBase-CL7l6VBn.js";import"./interopRequireDefault-SN6WmYz-.js";import"./useSlotProps-X5HMrML7.js";import"./utils-O8XFttzJ.js";import"./Paper-VLs7bu9J.js";import"./List-YTKgFfPW.js";import"./CircularProgress-8SwvdjS4.js";const Be=()=>{const[q,m]=u.useState(!1),[B,x]=u.useState(""),{id:h}=K(),D=V(),{token:p}=ee(),{books:b,questions:g,syllabus:c,deptLoading:w,getDepartments:r}=se();let t=b==null?void 0:b.find(e=>(e==null?void 0:e._id)===h);t!=null&&t._id||(t=g==null?void 0:g.find(e=>(e==null?void 0:e._id)===h)),t!=null&&t._id||(t=c==null?void 0:c.find(e=>(e==null?void 0:e._id)===h)),u.useEffect(()=>{x(t==null?void 0:t.categories),r.length>0&&(t!=null&&t.categories)&&(r!=null&&r.includes(t==null?void 0:t.categories)||(x("others"),m(!0)))},[w]);const[s,Q]=u.useState(t),[W,A]=Y.useState(t==null?void 0:t.semester),f=(e,a)=>{const l=[...e],H=l.findIndex(j=>(j==null?void 0:j._id)===(a==null?void 0:a._id));return l[H]=s,l},[I,{loading:N}]=v(X,{update(e,{data:{editBook:a}}){const{getBooks:l}=e.readQuery({query:k});e.writeQuery({query:k,data:{getBooks:f(l,a)}})}}),[O,{loading:P}]=v(Z,{update(e,{data:{editQuestion:a}}){const{getQuestions:l}=e.readQuery({query:E});e.writeQuery({query:E,data:{getQuestions:f(l,a)}})}}),[G,{loading:F}]=v($,{update(e,{data:{editSyllabus:a}}){const{getAllSyllabus:l}=e.readQuery({query:L});e.writeQuery({query:L,data:{getAllSyllabus:f(l,a)}})}}),R=e=>{const{target:{value:a}}=e;A(a),n(e)},n=e=>{Q({...s,[e.target.name]:e.target.value})},M=e=>{e.target.value.trim()==="others"?m(!0):(n(e),m(!1)),x(e.target.value.trim())},S=e=>{e.preventDefault(),window.confirm("Are you sure want to update?")&&((s==null?void 0:s.sub_categories)==="syllabus"?G({variables:{token:p,...s}}):(s==null?void 0:s.sub_categories)==="book"?I({variables:{token:p,...s}}):(s==null?void 0:s.sub_categories)==="question"&&O({variables:{token:p,...s}}),e.target.reset(),D(-1))};return i.jsxs(z,{children:[i.jsx(le,{variant:"h5",sx:{fontWeight:600,textAlign:"center",my:4},children:"EDIT CONTENT"}),i.jsx(U,{sx:{maxWidth:"450px",m:{md:"auto",xs:2},p:5,bgcolor:"white",borderRadius:2,boxShadow:"0.65px 1.75px 10px rgb(0, 0, 0, 0.3)"},children:i.jsxs("form",{onSubmit:S,children:[i.jsxs(y,{fullWidth:!0,sx:{mb:2},children:[i.jsx(_,{id:"demo-simple-select-label",children:"Category"}),i.jsxs(T,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:s==null?void 0:s.sub_categories,label:"Category",name:"sub_categories",onChange:n,required:!0,children:[i.jsx(o,{value:"syllabus",children:"Syllabus"}),i.jsx(o,{value:"book",children:"Book"}),i.jsx(o,{value:"question",children:"Question"})]})]}),i.jsx(d,{sx:{mb:2},id:"outlined-basic",label:"Title",value:s==null?void 0:s.book_name,name:"book_name",variant:"outlined",onChange:n,fullWidth:!0,required:!0}),(s==null?void 0:s.sub_categories)==="book"&&i.jsxs(C,{container:!0,spacing:{md:2},sx:{transition:"0.5s ease-in-out"},children:[i.jsx(C,{item:!0,md:8,xs:12,sx:{transition:"0.5s ease-in-out"},children:i.jsx(d,{sx:{mb:2},id:"outlined-basic",label:"Author",value:s==null?void 0:s.author,name:"author",variant:"outlined",onChange:n,fullWidth:!0})}),i.jsx(C,{item:!0,md:4,xs:12,sx:{transition:"0.5s ease-in-out"},children:i.jsx(d,{sx:{mb:2},id:"outlined-basic",label:"Edition",value:s==null?void 0:s.edition,name:"edition",variant:"outlined",type:"number",onChange:n,fullWidth:!0})})]}),i.jsxs(y,{fullWidth:!0,sx:{mb:2},children:[i.jsx(_,{id:"department-selection",children:"Department"}),i.jsxs(T,{labelId:"department-selection",id:"department-selection",value:B,label:"Department",name:"categories",onChange:M,required:!0,children:[!w&&r.map((e,a)=>e&&i.jsx(o,{value:e,children:i.jsx(ne,{title:J[e]||"",placement:"top-start",arrow:!0,children:i.jsx("div",{className:"w-full",children:e.toUpperCase()})})},a)),i.jsx(o,{value:"others",children:"OTHERS"})]})]}),q?i.jsx(d,{sx:{mb:2},id:"outlined-basic",defaultValue:s==null?void 0:s.categories,label:"Unknown Department Name",name:"categories",variant:"outlined",onChange:n,fullWidth:!0,required:!0}):null,i.jsxs(y,{fullWidth:!0,sx:{mb:2},children:[i.jsx(_,{htmlFor:"semester-select",children:"Semester"}),i.jsx(T,{value:W??[],multiple:!0,id:"semester-select",label:"Semester",name:"semester",onChange:R,renderValue:e=>i.jsx(U,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(a=>i.jsx(ie,{label:a},a))}),children:te.map(e=>e!=null&&e.title?i.jsx(ae,{sx:{fontWeight:"700"},children:e.title},e.title):i.jsx(o,{value:e,sx:{ml:1},children:e},e))})]}),i.jsx(d,{sx:{mb:2},id:"outlined-basic",label:"Download link",value:s==null?void 0:s.download_link,name:"download_link",variant:"outlined",onChange:n,fullWidth:!0,required:!0}),F||P||N?i.jsx(oe,{sx:{width:"100%"},loading:!0,variant:"contained",children:"Loading"}):i.jsx(re,{type:"submit",sx:{width:"100%"},variant:"contained",disabled:!(s!=null&&s.sub_categories&&(s!=null&&s.book_name)&&(s!=null&&s.categories)&&(s!=null&&s.download_link)),children:"submit"})]})})]})};export{Be as default};
